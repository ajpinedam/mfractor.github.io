<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Matthew Robbins">
  <link rel="shortcut icon" href="../../../img/favicon.ico">
  
  <title>Android C# Analysis - mfractor docs</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/highlight.css">
  <link href="../../../css/breadcrumbs.css" rel="stylesheet">
  <link href="../../../css/code.css" rel="stylesheet">
  <link href="../../../css/fabric.css" rel="stylesheet">
  <link href="../../../css/sidenav.css" rel="stylesheet">
  <link href="../../../css/mfractor.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Android C# Analysis";
    var mkdocs_page_input_path = "code-analysis/csharp/android.md";
    var mkdocs_page_url = "/code-analysis/csharp/android/";
  </script>
  
  <script src="../../../js/jquery-2.1.1.min.js"></script>
  <script src="../../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../../js/highlight.pack.js"></script> 
  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-71910290-3', 'docs.mfractor.com');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../../.." class="icon icon-home"> mfractor docs</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
          
            <li>
<li class="toctree-l1 ">
  <a class="" href="../../..">Home</a>
  
</li>
<li>
          
            <li>
<ul class="subnav">
  <li><span>Getting Started</span></li>
  
  
<li class="toctree-l1 ">
  <a class="" href="../../../installation-and-setup/">Installation And Setup</a>
  
</li>

  
  
<li class="toctree-l1 ">
  <a class="" href="../../../mfractor-professional/">About MFractor Professional</a>
  
</li>

  
  
<li class="toctree-l1 ">
  <a class="" href="../../../code-actions/">Code Actions</a>
  
</li>

  
  
<li class="toctree-l1 ">
  <a class="" href="../../../image-importing-wizard/">Image Importing Wizard</a>
  
</li>

  
  
<li class="toctree-l1 ">
  <a class="" href="../../../localisation-wizard/">Localisation Wizard</a>
  
</li>

  
  
<li class="toctree-l1 ">
  <a class="" href="../../../annotations/">Using MFractor.Annotations</a>
  
</li>

  
</ul>
<li>
          
            <li>
<ul class="subnav">
  <li><span>Configuring MFractor</span></li>
  
  
<li class="toctree-l1 ">
  <a class="" href="../../../configuration/getting-started/">Getting Started</a>
  
</li>

  
  
<li class="toctree-l1 ">
  <a class="" href="../../../configuration/code-snippets/">Code Snippets</a>
  
</li>

  
  
<li class="toctree-l1 ">
  <a class="" href="../../../configuration/configuration-property-types/">Types</a>
  
</li>

  
  
<li class="toctree-l1 ">
  <a class="" href="../../../configuration/resx/">ResX</a>
  
</li>

  
  
<li class="toctree-l1 ">
  <a class="" href="../../../configuration/xamarin-forms/">Xamarin.Forms</a>
  
</li>

  
</ul>
<li>
          
            <li>
<ul class="subnav">
  <li><span>Xamarin.Forms</span></li>
  
  
<li class="toctree-l1 ">
  <a class="" href="../../../xamarin-forms/configure-binding-context/">Configuring A Binding Context</a>
  
</li>

  
  
<li class="toctree-l1 ">
  <a class="" href="../../../xamarin-forms/navigation/">Navigation Tools</a>
  
</li>

  
  
<li class="toctree-l1 ">
  <a class="" href="../../../xamarin-forms/analysis/">Analysis</a>
  
</li>

  
  
<li class="toctree-l1 ">
  <a class="" href="../../../xamarin-forms/implementing-view-models/">Implementing View Models</a>
  
</li>

  
  
<li class="toctree-l1 ">
  <a class="" href="../../../xamarin-forms/value-converter-type-safety/">Value Converter Type Safety</a>
  
</li>

  
</ul>
<li>
          
            <li>
<ul class="subnav">
  <li><span>Xamarin.Android</span></li>
  
  
<li class="toctree-l1 ">
  <a class="" href="../../../xamarin-android/navigation-tools/">Navigation Tools</a>
  
</li>

  
  
<li class="toctree-l1 ">
  <a class="" href="../../../xamarin-android/resource-intellisense/">Resource IntelliSense</a>
  
</li>

  
</ul>
<li>
          
            <li>
<ul class="subnav">
  <li><span>Code Actions</span></li>
  
  
<ul class="subnav">
  <li><span>C#</span></li>
  
  
<li class="toctree-l1 ">
  <a class="" href="../../../code-actions/csharp/">C# Code Actions</a>
  
</li>

  
  
<li class="toctree-l1 ">
  <a class="" href="../../../code-actions/csharp/android/">Android</a>
  
</li>

  
</ul>

  
  
<ul class="subnav">
  <li><span>Xamarin.Forms Xaml Code Actions</span></li>
  
  
<li class="toctree-l1 ">
  <a class="" href="../../../code-actions/xaml/fix/">Issue Fixing</a>
  
</li>

  
  
<li class="toctree-l1 ">
  <a class="" href="../../../code-actions/xaml/generate/">Code Generation</a>
  
</li>

  
  
<li class="toctree-l1 ">
  <a class="" href="../../../code-actions/xaml/organise/">Xaml Organisation</a>
  
</li>

  
  
<li class="toctree-l1 ">
  <a class="" href="../../../code-actions/xaml/refactor/">Refactoring</a>
  
</li>

  
  
<li class="toctree-l1 ">
  <a class="" href="../../../code-actions/xaml/navigate/">Navigation</a>
  
</li>

  
</ul>

  
  
<li class="toctree-l1 ">
  <a class="" href="../../../code-actions/xml/">XML Code Actions</a>
  
</li>

  
</ul>
<li>
          
            <li>
<ul class="subnav">
  <li><span>Code Analysis</span></li>
  
  
<ul class="subnav">
  <li><span>C#</span></li>
  
  
<li class="toctree-l1 current">
  <a class="current" href="./">Android C# Analysis</a>
  
  <ul>
    
      
    
      
      <li class="toctree-l3"><a href="#activity-icon-should-be-mip-map">Activity Icon Should Be Mip Map</a></li>
      
    
      
      <li class="toctree-l3"><a href="#application-requires-peer-connection-constructor">Application Requires Peer Connection Constructor</a></li>
      
    
      
      <li class="toctree-l3"><a href="#check-androidcontentresresources-usages">Check Android.Content.Res.Resources Usages</a></li>
      
    
      
      <li class="toctree-l3"><a href="#check-views-exist-in-layout">Check Views Exist In Layout</a></li>
      
    
      
      <li class="toctree-l3"><a href="#class-derives-from-ijavaobject">Class Derives From IJavaObject</a></li>
      
    
      
      <li class="toctree-l3"><a href="#incorrect-activity-creation">Incorrect Activity Creation</a></li>
      
    
      
      <li class="toctree-l3"><a href="#validate-cheeseknife-attributes">Validate Cheeseknife Attributes</a></li>
      
    
      
      <li class="toctree-l3"><a href="#verify-toast-is-shown">Verify Toast Is Shown</a></li>
      
    
      
      <li class="toctree-l3"><a href="#warn-of-static-context-references">Warn Of Static Context References</a></li>
      
    
  </ul>
  
</li>

  
  
<li class="toctree-l1 ">
  <a class="" href="../xamarin-forms/">Xamarin.Forms C# Analysis</a>
  
</li>

  
</ul>

  
  
<li class="toctree-l1 ">
  <a class="" href="../../xaml/">XAML Analysis</a>
  
</li>

  
  
<li class="toctree-l1 ">
  <a class="" href="../../configuration/">MFractor Configuration Analysis</a>
  
</li>

  
</ul>
<li>
          
            <li>
<ul class="subnav">
  <li><span>Code Generation</span></li>
  
  
<ul class="subnav">
  <li><span>C#</span></li>
  
  
<li class="toctree-l1 ">
  <a class="" href="../../../code-generation/csharp/">C#</a>
  
</li>

  
</ul>

  
  
<li class="toctree-l1 ">
  <a class="" href="../../../code-generation/csharp/android/">Android (C#)</a>
  
</li>

  
  
<li class="toctree-l1 ">
  <a class="" href="../../../code-generation/xamarin-forms/">Xamarin.Forms (C#)</a>
  
</li>

  
  
<li class="toctree-l1 ">
  <a class="" href="../../../code-generation/xaml/">Xaml</a>
  
</li>

  
  
<li class="toctree-l1 ">
  <a class="" href="../../../code-generation/resx/">ResX</a>
  
</li>

  
  
<li class="toctree-l1 ">
  <a class="" href="../../../code-generation/xml/">XML</a>
  
</li>

  
</ul>
<li>
          
            <li>
<ul class="subnav">
  <li><span>Release Notes</span></li>
  
  
<li class="toctree-l1 ">
  <a class="" href="../../../release-notes/v3-4/">v3.4</a>
  
</li>

  
  
<li class="toctree-l1 ">
  <a class="" href="../../../release-notes/v3-3/">v3.3</a>
  
</li>

  
  
<li class="toctree-l1 ">
  <a class="" href="../../../release-notes/v3-2/">v3.2</a>
  
</li>

  
  
<li class="toctree-l1 ">
  <a class="" href="../../../release-notes/v3-1/">v3.1</a>
  
</li>

  
  
<li class="toctree-l1 ">
  <a class="" href="../../../release-notes/v3-0/">v3.0</a>
  
</li>

  
  
<li class="toctree-l1 ">
  <a class="" href="../../../release-notes/v2/">v2</a>
  
</li>

  
</ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../..">mfractor docs</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../..">Docs</a> &raquo;</li>
    
      
        
          <li>Code Analysis &raquo;</li>
        
      
        
          <li>C# &raquo;</li>
        
      
    
    <li>Android C# Analysis</li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h2 id="android-c-code-analysis">Android C# Code Analysis</h2>
<p><em>Autogenerated by MFractor v3.3.0</em></p>
<h2 id="activity-icon-should-be-mip-map">Activity Icon Should Be Mip Map</h2>
<p>Inspects usages of the <code>[Activity]</code> attribute and validates the <code>Icon</code> property uses a mip map instead of a drawable.</p>
<h2 id="application-requires-peer-connection-constructor">Application Requires Peer Connection Constructor</h2>
<p><img alt="MFractor detecting an unimplemented Application peer connection constructor" src="../../../img/code-analysis/android/application-constructor-0.png" /></p>
<p>In Xamarin.Android applications, it is often necessary to implement a custom <code>Android.App.Application</code> subclass. Unfortunately this has a nasty edgecase; <code>Application</code> subclasses <strong>must</strong> manually implement the peer connection constructor otherwise the Xamarin.Android runtime cannot instantiate it!</p>
<p>Consider the following application subclass:</p>
<p><strong>MyApplication.cs</strong></p>
<pre><code>[Application(Name=&quot;com.companyname.myandroidapp.MyApplication&quot;, Icon=&quot;@mipmap/icon&quot;, Label=&quot;@string/app_name&quot;)]
public class MyApplication : Application
{
    public override void OnCreate()
    {
        base.OnCreate();
    }
}
</code></pre>

<p>At a glance, this seems perfectly reasonable. However, when the <code>OnCreate</code> method is called by the Xamarin.Android runtime, it generates a <code>System.NotSupportedException</code> when the Java counterpart for the managed <code>Application</code> class cannot be bound:</p>
<p><img alt="The System.NotSupportedException caused by not having a peer connection constructor" src="../../../img/code-analysis/android/application-constructor-1.png" /></p>
<p>This can be fixed by implementing the peer connection constructor for the <code>Application</code> class:</p>
<p><strong>MyApplication.cs</strong></p>
<pre><code>[Application(Name = &quot;com.companyname.myandroidapp.MyApplication&quot;, Icon = &quot;@mipmap/icon&quot;, Label = &quot;@string/app_name&quot;)]
public class MyApplication : Application
{
    public MyApplication(System.IntPtr javaReference, Android.Runtime.JniHandleOwnership transfer)
        : base(javaReference, transfer)
    {
    }

    public override void OnCreate()
    {
        base.OnCreate();
    }
}
</code></pre>

<p>To quickly fix this code issue, you can use the <a href="../../../code-actions/csharp/#implement-base-class-constructors">implement base class constructors code action</a>.</p>
<p><strong>Refer To:</strong></p>
<ul>
<li><a href="https://stackoverflow.com/questions/21427981/how-to-register-my-own-application-subclass-in-xamarin-android">How to register my own Application subclass in Xamarin.Android?</a></li>
<li><a href="https://forums.xamarin.com/discussion/2147/what-is-the-recipe-to-have-a-working-application-derived-class">What is the recipe to have a working Application-derived class?</a></li>
</ul>
<h2 id="check-androidcontentresresources-usages">Check Android.Content.Res.Resources Usages</h2>
<p>When using the Android.Content.Res.Resources class, all Get* expressions expect the correct resource type identifier. For example, when using Resource.GetString(), a resource identifier of Resources.String.myString is expected. Passing any other resource identifier such as Resource.Color.myColor may result in unintended data being used or runtime exceptions. This code analyser validates that the correct resource type is being provided to the API call.</p>
<h2 id="check-views-exist-in-layout">Check Views Exist In Layout</h2>
<p>When connecting Android layouts (<code>axml</code> files located under <code>Resources/Layout</code>), developers pull views out of their bound layout with the <code>FindViewById</code> method.</p>
<p>Take this example layout:</p>
<p><strong>Main.axml</strong></p>
<pre><code>&lt;LinearLayout&gt;
    &lt;Button android:id=&quot;+@id/mainButton&quot;/&gt;
&lt;/LinearLayout&gt;
</code></pre>

<p><strong>MyActivity.cs</strong></p>
<pre><code>public class MyActivity : Activity
{
    public void OnCreate()
    {
        SetContentView(Resource.Layout.Main);
        var button = FindViewById&lt;Button&gt;(Resource.Id.mainButton);
    }
}
</code></pre>

<p>The developer is retrieving the <code>mainButton</code> from the <code>Main.axml</code> layout that was bound using the <code>SetContentView(Resource.Layout.Main)</code> invocation.</p>
<p>In large scale applications, as the amount of layouts grows, it becomes very easy to accidentally retrieve the wrong button from the layout.</p>
<p>Say another layout defined <code>secondaryButton</code>... Consider the following:</p>
<p><strong>MyActivity.cs</strong></p>
<pre><code>public class MyActivity : Activity
{
    public void OnCreate()
    {
        SetContentView(Resource.Layout.Main);
        var button = FindViewById&lt;Button&gt;(Resource.Id.secondaryButton);
    }
}
</code></pre>

<p>The developer is accidentally pulling out the <code>secondaryButton</code> id from <code>Main.axml</code> but <code>Main.axml</code> defines <code>mainButton</code>; this will cause a runtime exception when the <code>MainActivity</code> is created.</p>
<p>MFractor provides the <a href="../../../annotations/">MFractor.Annotations</a> library that lets developers declare their layout uses for a class, enabling MFractor to inspect <code>FindViewById</code> calls and check that the <code>Resource.Id</code> provided exists in a particular layout.</p>
<p><strong>MyActivity.cs</strong></p>
<pre><code>[MFractor.Annotations.Android.UsesLayout(Resource.Layout.Main)]
public class MyActivity : Activity
{
    // ...
}
</code></pre>

<p>MFractor will look for a <code>secondaryButton</code> declaration in all configurations of <code>Main.axml</code> and provide a code warning if it cannot be found:</p>
<p><img alt="Inspecting for missing views in a layout using the UsesLayout analyser" src="../../../img/code-analysis/android/uses-layout-analysis.png" /></p>
<h2 id="class-derives-from-ijavaobject">Class Derives From IJavaObject</h2>
<p>Often when creating new classes in a Xamarin.Android codebase developers will need a new class to be usable between Java and C#. Xamarin.Android provides the IJavaObject interface to expose a class to Java. Instead of directly inheriting from the IJavaObject interface, a developer should instead inherit from Java.Lang.Object which implements the required interface members.</p>
<h2 id="incorrect-activity-creation">Incorrect Activity Creation</h2>
<p>This analyser detects when a developer is instantiating an Android activity or activity subclass directly using a new expression. Activities should only ever be created through the operating system; creating them through a new expression leaves them in an invalid state.</p>
<h2 id="validate-cheeseknife-attributes">Validate Cheeseknife Attributes</h2>
<p>This analyser inspect usages of attributes from the Cheeseknife view injection library; it validates that the Resource.Id.* exists in the layout provided into an MFractor.Annotations UsesLayout attribute.</p>
<h2 id="verify-toast-is-shown">Verify Toast Is Shown</h2>
<p>Sometimes when a Toast is created via MakeText, the Show method is accidently omitted. This analysis routine looks for invocations of Toast.MakeText() that don't then invoke the Show() method on the toast object in the same expression. If the MakeText() result is assigned into a variable or passed as a method argument then this check is skipped.</p>
<h2 id="warn-of-static-context-references">Warn Of Static Context References</h2>
<p>This analyser inspects static variable declarations within classes and checks if the type derives from Android.Content.Context. Static context references have the potential to cause large memory leaks.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../xamarin-forms/" class="btn btn-neutral float-right" title="Xamarin.Forms C# Analysis">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../../code-actions/xml/" class="btn btn-neutral" title="XML Code Actions"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div class="fastlane" role="contentinfo">
    <p>
      <a href="https://www.mfractor.com" target="_blank">
        <img src="/img/logo-horizontal.png" width="200" />
      </a>
    </p>
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a> - Copyright &copy; 2016 <a href="https://www.mfractor.com">MFractor</a>
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/mfractor/mfractor.github.io" class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../../../code-actions/xml/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../xamarin-forms/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="../../../js/theme.js"></script>

</body>
</html>
